From 903805b547a6dc49dba26c6e826a889814a6208c Mon Sep 17 00:00:00 2001
From: =?utf-8?q?Marc-Andr=E9=20Lureau?= <marcandre.lureau@gmail.com>
Date: Wed, 27 Aug 2008 19:59:51 +0300
Subject: [PATCH] autofoo

---
 Makefile.in     |    2 +-
 aclocal.m4      |   57 ++++--
 config.h.in     |    3 +
 configure       |  587 ++++++++++++++++++++++++++++++++-----------------------
 ltmain.sh       |   12 +-
 src/Makefile.in |   34 +++-
 6 files changed, 430 insertions(+), 265 deletions(-)

diff --git a/Makefile.in b/Makefile.in
index 0237d4c..f580ac8 100644
--- a/Makefile.in
+++ b/Makefile.in
@@ -62,7 +62,7 @@ DIST_COMMON = README $(am__configure_deps) $(srcdir)/Makefile.am \
 	$(srcdir)/libpulse-mainloop-glib.pc.in \
 	$(srcdir)/libpulse-simple.pc.in $(srcdir)/libpulse.pc.in \
 	$(top_srcdir)/configure $(top_srcdir)/src/pulse/version.h.in \
-	compile config.guess config.rpath config.sub depcomp \
+	ChangeLog compile config.guess config.rpath config.sub depcomp \
 	install-sh ltmain.sh missing
 ACLOCAL_M4 = $(top_srcdir)/aclocal.m4
 am__aclocal_m4_deps = $(top_srcdir)/acinclude.m4 \
diff --git a/aclocal.m4 b/aclocal.m4
index 3ed3bae..1ed8423 100644
--- a/aclocal.m4
+++ b/aclocal.m4
@@ -1209,7 +1209,7 @@ AC_DEFUN([AC_LIB_PREPARE_MULTILIB],
 
 # libtool.m4 - Configure libtool for the host system. -*-Autoconf-*-
 
-# serial 52 AC_PROG_LIBTOOL
+# serial 52 Debian 1.5.26-4 AC_PROG_LIBTOOL
 
 
 # AC_PROVIDE_IFELSE(MACRO-NAME, IF-PROVIDED, IF-NOT-PROVIDED)
@@ -1833,7 +1833,6 @@ s390*-*linux*|sparc*-*linux*)
       esac
       ;;
     *64-bit*)
-      libsuff=64
       case $host in
         x86_64-*kfreebsd*-gnu)
           LD="${LD-ld} -m elf_x86_64_fbsd"
@@ -2896,13 +2895,11 @@ linux* | k*bsd*-gnu)
   # Some rework will be needed to allow for fast_install
   # before this can be enabled.
   hardcode_into_libs=yes
-  sys_lib_search_path_spec="/usr/lib${libsuff} /lib${libsuff} /usr/local/lib${libsuff}"
-  sys_lib_dlsearch_path_spec="/usr/lib${libsuff} /lib${libsuff}"
 
   # Append ld.so.conf contents to the search path
   if test -f /etc/ld.so.conf; then
     lt_ld_extra=`awk '/^include / { system(sprintf("cd /etc; cat %s 2>/dev/null", \[$]2)); skip = 1; } { if (!skip) print \[$]0; skip = 0; }' < /etc/ld.so.conf | $SED -e 's/#.*//;/^[ 	]*hwcap[ 	]/d;s/[:,	]/ /g;s/=[^=]*$//;s/=[^= ]* / /g;/^$/d' | tr '\n' ' '`
-    sys_lib_dlsearch_path_spec="$sys_lib_dlsearch_path_spec $lt_ld_extra"
+    sys_lib_dlsearch_path_spec="/lib /usr/lib $lt_ld_extra"
   fi
 
   # We used to test for /lib/ld.so.1 and disable shared libraries on
@@ -2914,6 +2911,18 @@ linux* | k*bsd*-gnu)
   dynamic_linker='GNU/Linux ld.so'
   ;;
 
+netbsdelf*-gnu)
+  version_type=linux
+  need_lib_prefix=no
+  need_version=no
+  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major ${libname}${shared_ext}'
+  soname_spec='${libname}${release}${shared_ext}$major'
+  shlibpath_var=LD_LIBRARY_PATH
+  shlibpath_overrides_runpath=no
+  hardcode_into_libs=yes
+  dynamic_linker='NetBSD ld.elf_so'
+  ;;
+
 netbsd*)
   version_type=sunos
   need_lib_prefix=no
@@ -3695,7 +3704,7 @@ linux* | k*bsd*-gnu)
   lt_cv_deplibs_check_method=pass_all
   ;;
 
-netbsd*)
+netbsd* | netbsdelf*-gnu)
   if echo __ELF__ | $CC -E - | grep __ELF__ > /dev/null; then
     lt_cv_deplibs_check_method='match_pattern /lib[[^/]]+(\.so\.[[0-9]]+\.[[0-9]]+|_pic\.a)$'
   else
@@ -4702,7 +4711,7 @@ case $host_os in
 	;;
     esac
     ;;
-  netbsd*)
+  netbsd* | netbsdelf*-gnu)
     if echo __ELF__ | $CC -E - | grep __ELF__ >/dev/null; then
       _LT_AC_TAGVAR(archive_cmds, $1)='$LD -Bshareable  -o $lib $predep_objects $libobjs $deplibs $postdep_objects $linker_flags'
       wlarc=
@@ -6394,7 +6403,7 @@ AC_MSG_CHECKING([for $compiler option to produce PIC])
 	    ;;
 	esac
 	;;
-      netbsd*)
+      netbsd* | netbsdelf*-gnu)
 	;;
       osf3* | osf4* | osf5*)
 	case $cc_basename in
@@ -6771,6 +6780,9 @@ ifelse([$1],[CXX],[
   cygwin* | mingw*)
     _LT_AC_TAGVAR(export_symbols_cmds, $1)='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[[BCDGRS]][[ ]]/s/.*[[ ]]\([[^ ]]*\)/\1 DATA/;/^.*[[ ]]__nm__/s/^.*[[ ]]__nm__\([[^ ]]*\)[[ ]][[^ ]]*/\1 DATA/;/^I[[ ]]/d;/^[[AITW]][[ ]]/s/.*[[ ]]//'\'' | sort | uniq > $export_symbols'
   ;;
+  linux* | k*bsd*-gnu)
+    _LT_AC_TAGVAR(link_all_deplibs, $1)=no
+  ;;
   *)
     _LT_AC_TAGVAR(export_symbols_cmds, $1)='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   ;;
@@ -6979,12 +6991,13 @@ EOF
   $echo "local: *; };" >> $output_objdir/$libname.ver~
 	  $CC '"$tmp_sharedflag""$tmp_addflag"' $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-version-script ${wl}$output_objdir/$libname.ver -o $lib'
 	fi
+	_LT_AC_TAGVAR(link_all_deplibs, $1)=no
       else
 	_LT_AC_TAGVAR(ld_shlibs, $1)=no
       fi
       ;;
 
-    netbsd*)
+    netbsd* | netbsdelf*-gnu)
       if echo __ELF__ | $CC -E - | grep __ELF__ >/dev/null; then
 	_LT_AC_TAGVAR(archive_cmds, $1)='$LD -Bshareable $libobjs $deplibs $linker_flags -o $lib'
 	wlarc=
@@ -7415,7 +7428,7 @@ _LT_EOF
       _LT_AC_TAGVAR(link_all_deplibs, $1)=yes
       ;;
 
-    netbsd*)
+    netbsd* | netbsdelf*-gnu)
       if echo __ELF__ | $CC -E - | grep __ELF__ >/dev/null; then
 	_LT_AC_TAGVAR(archive_cmds, $1)='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'  # a.out
       else
@@ -7992,7 +8005,7 @@ AC_CACHE_CHECK([whether deplibs are loaded by dlopen],
     # at 6.2 and later dlopen does load deplibs.
     libltdl_cv_sys_dlopen_deplibs=yes
     ;;
-  netbsd*)
+  netbsd* | netbsdelf*-gnu)
     libltdl_cv_sys_dlopen_deplibs=yes
     ;;
   openbsd*)
@@ -8333,14 +8346,16 @@ fi])
 # _PKG_CONFIG([VARIABLE], [COMMAND], [MODULES])
 # ---------------------------------------------
 m4_define([_PKG_CONFIG],
-[if test -n "$$1"; then
-    pkg_cv_[]$1="$$1"
- elif test -n "$PKG_CONFIG"; then
-    PKG_CHECK_EXISTS([$3],
-                     [pkg_cv_[]$1=`$PKG_CONFIG --[]$2 "$3" 2>/dev/null`],
-		     [pkg_failed=yes])
- else
-    pkg_failed=untried
+[if test -n "$PKG_CONFIG"; then
+    if test -n "$$1"; then
+        pkg_cv_[]$1="$$1"
+    else
+        PKG_CHECK_EXISTS([$3],
+                         [pkg_cv_[]$1=`$PKG_CONFIG --[]$2 "$3" 2>/dev/null`],
+			 [pkg_failed=yes])
+    fi
+else
+	pkg_failed=untried
 fi[]dnl
 ])# _PKG_CONFIG
 
@@ -8384,9 +8399,9 @@ See the pkg-config man page for more details.])
 if test $pkg_failed = yes; then
         _PKG_SHORT_ERRORS_SUPPORTED
         if test $_pkg_short_errors_supported = yes; then
-	        $1[]_PKG_ERRORS=`$PKG_CONFIG --short-errors --print-errors "$2" 2>&1`
+	        $1[]_PKG_ERRORS=`$PKG_CONFIG --short-errors --errors-to-stdout --print-errors "$2"`
         else 
-	        $1[]_PKG_ERRORS=`$PKG_CONFIG --print-errors "$2" 2>&1`
+	        $1[]_PKG_ERRORS=`$PKG_CONFIG --errors-to-stdout --print-errors "$2"`
         fi
 	# Put the nasty error message in config.log where it belongs
 	echo "$$1[]_PKG_ERRORS" >&AS_MESSAGE_LOG_FD
diff --git a/config.h.in b/config.h.in
index 34993c1..c98a0a7 100644
--- a/config.h.in
+++ b/config.h.in
@@ -413,6 +413,9 @@
 /* Access group */
 #undef PA_ACCESS_GROUP
 
+/* The CFLAGS used during compilation */
+#undef PA_CFLAGS
+
 /* Realtime group */
 #undef PA_REALTIME_GROUP
 
diff --git a/configure b/configure
index ae1412b..2182d41 100755
--- a/configure
+++ b/configure
@@ -5987,7 +5987,7 @@ linux* | k*bsd*-gnu)
   lt_cv_deplibs_check_method=pass_all
   ;;
 
-netbsd*)
+netbsd* | netbsdelf*-gnu)
   if echo __ELF__ | $CC -E - | grep __ELF__ > /dev/null; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
   else
@@ -6172,7 +6172,6 @@ s390*-*linux*|sparc*-*linux*)
       esac
       ;;
     *64-bit*)
-      libsuff=64
       case $host in
         x86_64-*kfreebsd*-gnu)
           LD="${LD-ld} -m elf_x86_64_fbsd"
@@ -9020,11 +9019,11 @@ else
    -e 's:.*FLAGS}\{0,1\} :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:9023: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:9022: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>conftest.err)
    ac_status=$?
    cat conftest.err >&5
-   echo "$as_me:9027: \$? = $ac_status" >&5
+   echo "$as_me:9026: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
@@ -9310,11 +9309,11 @@ else
    -e 's:.*FLAGS}\{0,1\} :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:9313: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:9312: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>conftest.err)
    ac_status=$?
    cat conftest.err >&5
-   echo "$as_me:9317: \$? = $ac_status" >&5
+   echo "$as_me:9316: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
@@ -9414,11 +9413,11 @@ else
    -e 's:.*FLAGS}\{0,1\} :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:9417: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:9416: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>out/conftest.err)
    ac_status=$?
    cat out/conftest.err >&5
-   echo "$as_me:9421: \$? = $ac_status" >&5
+   echo "$as_me:9420: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
    then
      # The compiler can only warn and ignore the option if not recognized
@@ -9679,12 +9678,13 @@ EOF
   $echo "local: *; };" >> $output_objdir/$libname.ver~
 	  $CC '"$tmp_sharedflag""$tmp_addflag"' $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-version-script ${wl}$output_objdir/$libname.ver -o $lib'
 	fi
+	link_all_deplibs=no
       else
 	ld_shlibs=no
       fi
       ;;
 
-    netbsd*)
+    netbsd* | netbsdelf*-gnu)
       if echo __ELF__ | $CC -E - | grep __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable $libobjs $deplibs $linker_flags -o $lib'
 	wlarc=
@@ -10235,7 +10235,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
       link_all_deplibs=yes
       ;;
 
-    netbsd*)
+    netbsd* | netbsdelf*-gnu)
       if echo __ELF__ | $CC -E - | grep __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'  # a.out
       else
@@ -10930,13 +10930,11 @@ linux* | k*bsd*-gnu)
   # Some rework will be needed to allow for fast_install
   # before this can be enabled.
   hardcode_into_libs=yes
-  sys_lib_search_path_spec="/usr/lib${libsuff} /lib${libsuff} /usr/local/lib${libsuff}"
-  sys_lib_dlsearch_path_spec="/usr/lib${libsuff} /lib${libsuff}"
 
   # Append ld.so.conf contents to the search path
   if test -f /etc/ld.so.conf; then
     lt_ld_extra=`awk '/^include / { system(sprintf("cd /etc; cat %s 2>/dev/null", \$2)); skip = 1; } { if (!skip) print \$0; skip = 0; }' < /etc/ld.so.conf | $SED -e 's/#.*//;/^[ 	]*hwcap[ 	]/d;s/[:,	]/ /g;s/=[^=]*$//;s/=[^= ]* / /g;/^$/d' | tr '\n' ' '`
-    sys_lib_dlsearch_path_spec="$sys_lib_dlsearch_path_spec $lt_ld_extra"
+    sys_lib_dlsearch_path_spec="/lib /usr/lib $lt_ld_extra"
   fi
 
   # We used to test for /lib/ld.so.1 and disable shared libraries on
@@ -10948,6 +10946,18 @@ linux* | k*bsd*-gnu)
   dynamic_linker='GNU/Linux ld.so'
   ;;
 
+netbsdelf*-gnu)
+  version_type=linux
+  need_lib_prefix=no
+  need_version=no
+  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major ${libname}${shared_ext}'
+  soname_spec='${libname}${release}${shared_ext}$major'
+  shlibpath_var=LD_LIBRARY_PATH
+  shlibpath_overrides_runpath=no
+  hardcode_into_libs=yes
+  dynamic_linker='NetBSD ld.elf_so'
+  ;;
+
 netbsd*)
   version_type=sunos
   need_lib_prefix=no
@@ -11816,7 +11826,7 @@ else
   lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2
   lt_status=$lt_dlunknown
   cat > conftest.$ac_ext <<EOF
-#line 11819 "configure"
+#line 11829 "configure"
 #include "confdefs.h"
 
 #if HAVE_DLFCN_H
@@ -11916,7 +11926,7 @@ else
   lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2
   lt_status=$lt_dlunknown
   cat > conftest.$ac_ext <<EOF
-#line 11919 "configure"
+#line 11929 "configure"
 #include "confdefs.h"
 
 #if HAVE_DLFCN_H
@@ -13512,7 +13522,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	;;
     esac
     ;;
-  netbsd*)
+  netbsd* | netbsdelf*-gnu)
     if echo __ELF__ | $CC -E - | grep __ELF__ >/dev/null; then
       archive_cmds_CXX='$LD -Bshareable  -o $lib $predep_objects $libobjs $deplibs $postdep_objects $linker_flags'
       wlarc=
@@ -14216,7 +14226,7 @@ $as_echo_n "checking for $compiler option to produce PIC... " >&6; }
 	    ;;
 	esac
 	;;
-      netbsd*)
+      netbsd* | netbsdelf*-gnu)
 	;;
       osf3* | osf4* | osf5*)
 	case $cc_basename in
@@ -14325,11 +14335,11 @@ else
    -e 's:.*FLAGS}\{0,1\} :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:14328: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:14338: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>conftest.err)
    ac_status=$?
    cat conftest.err >&5
-   echo "$as_me:14332: \$? = $ac_status" >&5
+   echo "$as_me:14342: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
@@ -14429,11 +14439,11 @@ else
    -e 's:.*FLAGS}\{0,1\} :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:14432: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:14442: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>out/conftest.err)
    ac_status=$?
    cat out/conftest.err >&5
-   echo "$as_me:14436: \$? = $ac_status" >&5
+   echo "$as_me:14446: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
    then
      # The compiler can only warn and ignore the option if not recognized
@@ -14501,6 +14511,9 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
   cygwin* | mingw*)
     export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/;/^.*[ ]__nm__/s/^.*[ ]__nm__\([^ ]*\)[ ][^ ]*/\1 DATA/;/^I[ ]/d;/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
   ;;
+  linux* | k*bsd*-gnu)
+    link_all_deplibs_CXX=no
+  ;;
   *)
     export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   ;;
@@ -14931,13 +14944,11 @@ linux* | k*bsd*-gnu)
   # Some rework will be needed to allow for fast_install
   # before this can be enabled.
   hardcode_into_libs=yes
-  sys_lib_search_path_spec="/usr/lib${libsuff} /lib${libsuff} /usr/local/lib${libsuff}"
-  sys_lib_dlsearch_path_spec="/usr/lib${libsuff} /lib${libsuff}"
 
   # Append ld.so.conf contents to the search path
   if test -f /etc/ld.so.conf; then
     lt_ld_extra=`awk '/^include / { system(sprintf("cd /etc; cat %s 2>/dev/null", \$2)); skip = 1; } { if (!skip) print \$0; skip = 0; }' < /etc/ld.so.conf | $SED -e 's/#.*//;/^[ 	]*hwcap[ 	]/d;s/[:,	]/ /g;s/=[^=]*$//;s/=[^= ]* / /g;/^$/d' | tr '\n' ' '`
-    sys_lib_dlsearch_path_spec="$sys_lib_dlsearch_path_spec $lt_ld_extra"
+    sys_lib_dlsearch_path_spec="/lib /usr/lib $lt_ld_extra"
   fi
 
   # We used to test for /lib/ld.so.1 and disable shared libraries on
@@ -14949,6 +14960,18 @@ linux* | k*bsd*-gnu)
   dynamic_linker='GNU/Linux ld.so'
   ;;
 
+netbsdelf*-gnu)
+  version_type=linux
+  need_lib_prefix=no
+  need_version=no
+  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major ${libname}${shared_ext}'
+  soname_spec='${libname}${release}${shared_ext}$major'
+  shlibpath_var=LD_LIBRARY_PATH
+  shlibpath_overrides_runpath=no
+  hardcode_into_libs=yes
+  dynamic_linker='NetBSD ld.elf_so'
+  ;;
+
 netbsd*)
   version_type=sunos
   need_lib_prefix=no
@@ -16014,11 +16037,11 @@ else
    -e 's:.*FLAGS}\{0,1\} :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:16017: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:16040: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>conftest.err)
    ac_status=$?
    cat conftest.err >&5
-   echo "$as_me:16021: \$? = $ac_status" >&5
+   echo "$as_me:16044: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
@@ -16118,11 +16141,11 @@ else
    -e 's:.*FLAGS}\{0,1\} :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:16121: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:16144: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>out/conftest.err)
    ac_status=$?
    cat out/conftest.err >&5
-   echo "$as_me:16125: \$? = $ac_status" >&5
+   echo "$as_me:16148: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
    then
      # The compiler can only warn and ignore the option if not recognized
@@ -16383,12 +16406,13 @@ EOF
   $echo "local: *; };" >> $output_objdir/$libname.ver~
 	  $CC '"$tmp_sharedflag""$tmp_addflag"' $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-version-script ${wl}$output_objdir/$libname.ver -o $lib'
 	fi
+	link_all_deplibs_F77=no
       else
 	ld_shlibs_F77=no
       fi
       ;;
 
-    netbsd*)
+    netbsd* | netbsdelf*-gnu)
       if echo __ELF__ | $CC -E - | grep __ELF__ >/dev/null; then
 	archive_cmds_F77='$LD -Bshareable $libobjs $deplibs $linker_flags -o $lib'
 	wlarc=
@@ -16919,7 +16943,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
       link_all_deplibs_F77=yes
       ;;
 
-    netbsd*)
+    netbsd* | netbsdelf*-gnu)
       if echo __ELF__ | $CC -E - | grep __ELF__ >/dev/null; then
 	archive_cmds_F77='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'  # a.out
       else
@@ -17562,13 +17586,11 @@ linux* | k*bsd*-gnu)
   # Some rework will be needed to allow for fast_install
   # before this can be enabled.
   hardcode_into_libs=yes
-  sys_lib_search_path_spec="/usr/lib${libsuff} /lib${libsuff} /usr/local/lib${libsuff}"
-  sys_lib_dlsearch_path_spec="/usr/lib${libsuff} /lib${libsuff}"
 
   # Append ld.so.conf contents to the search path
   if test -f /etc/ld.so.conf; then
     lt_ld_extra=`awk '/^include / { system(sprintf("cd /etc; cat %s 2>/dev/null", \$2)); skip = 1; } { if (!skip) print \$0; skip = 0; }' < /etc/ld.so.conf | $SED -e 's/#.*//;/^[ 	]*hwcap[ 	]/d;s/[:,	]/ /g;s/=[^=]*$//;s/=[^= ]* / /g;/^$/d' | tr '\n' ' '`
-    sys_lib_dlsearch_path_spec="$sys_lib_dlsearch_path_spec $lt_ld_extra"
+    sys_lib_dlsearch_path_spec="/lib /usr/lib $lt_ld_extra"
   fi
 
   # We used to test for /lib/ld.so.1 and disable shared libraries on
@@ -17580,6 +17602,18 @@ linux* | k*bsd*-gnu)
   dynamic_linker='GNU/Linux ld.so'
   ;;
 
+netbsdelf*-gnu)
+  version_type=linux
+  need_lib_prefix=no
+  need_version=no
+  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major ${libname}${shared_ext}'
+  soname_spec='${libname}${release}${shared_ext}$major'
+  shlibpath_var=LD_LIBRARY_PATH
+  shlibpath_overrides_runpath=no
+  hardcode_into_libs=yes
+  dynamic_linker='NetBSD ld.elf_so'
+  ;;
+
 netbsd*)
   version_type=sunos
   need_lib_prefix=no
@@ -18335,11 +18369,11 @@ else
    -e 's:.*FLAGS}\{0,1\} :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:18338: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:18372: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>conftest.err)
    ac_status=$?
    cat conftest.err >&5
-   echo "$as_me:18342: \$? = $ac_status" >&5
+   echo "$as_me:18376: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
@@ -18625,11 +18659,11 @@ else
    -e 's:.*FLAGS}\{0,1\} :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:18628: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:18662: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>conftest.err)
    ac_status=$?
    cat conftest.err >&5
-   echo "$as_me:18632: \$? = $ac_status" >&5
+   echo "$as_me:18666: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
@@ -18729,11 +18763,11 @@ else
    -e 's:.*FLAGS}\{0,1\} :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:18732: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:18766: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>out/conftest.err)
    ac_status=$?
    cat out/conftest.err >&5
-   echo "$as_me:18736: \$? = $ac_status" >&5
+   echo "$as_me:18770: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
    then
      # The compiler can only warn and ignore the option if not recognized
@@ -18994,12 +19028,13 @@ EOF
   $echo "local: *; };" >> $output_objdir/$libname.ver~
 	  $CC '"$tmp_sharedflag""$tmp_addflag"' $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-version-script ${wl}$output_objdir/$libname.ver -o $lib'
 	fi
+	link_all_deplibs_GCJ=no
       else
 	ld_shlibs_GCJ=no
       fi
       ;;
 
-    netbsd*)
+    netbsd* | netbsdelf*-gnu)
       if echo __ELF__ | $CC -E - | grep __ELF__ >/dev/null; then
 	archive_cmds_GCJ='$LD -Bshareable $libobjs $deplibs $linker_flags -o $lib'
 	wlarc=
@@ -19550,7 +19585,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
       link_all_deplibs_GCJ=yes
       ;;
 
-    netbsd*)
+    netbsd* | netbsdelf*-gnu)
       if echo __ELF__ | $CC -E - | grep __ELF__ >/dev/null; then
 	archive_cmds_GCJ='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'  # a.out
       else
@@ -20193,13 +20228,11 @@ linux* | k*bsd*-gnu)
   # Some rework will be needed to allow for fast_install
   # before this can be enabled.
   hardcode_into_libs=yes
-  sys_lib_search_path_spec="/usr/lib${libsuff} /lib${libsuff} /usr/local/lib${libsuff}"
-  sys_lib_dlsearch_path_spec="/usr/lib${libsuff} /lib${libsuff}"
 
   # Append ld.so.conf contents to the search path
   if test -f /etc/ld.so.conf; then
     lt_ld_extra=`awk '/^include / { system(sprintf("cd /etc; cat %s 2>/dev/null", \$2)); skip = 1; } { if (!skip) print \$0; skip = 0; }' < /etc/ld.so.conf | $SED -e 's/#.*//;/^[ 	]*hwcap[ 	]/d;s/[:,	]/ /g;s/=[^=]*$//;s/=[^= ]* / /g;/^$/d' | tr '\n' ' '`
-    sys_lib_dlsearch_path_spec="$sys_lib_dlsearch_path_spec $lt_ld_extra"
+    sys_lib_dlsearch_path_spec="/lib /usr/lib $lt_ld_extra"
   fi
 
   # We used to test for /lib/ld.so.1 and disable shared libraries on
@@ -20211,6 +20244,18 @@ linux* | k*bsd*-gnu)
   dynamic_linker='GNU/Linux ld.so'
   ;;
 
+netbsdelf*-gnu)
+  version_type=linux
+  need_lib_prefix=no
+  need_version=no
+  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major ${libname}${shared_ext}'
+  soname_spec='${libname}${release}${shared_ext}$major'
+  shlibpath_var=LD_LIBRARY_PATH
+  shlibpath_overrides_runpath=no
+  hardcode_into_libs=yes
+  dynamic_linker='NetBSD ld.elf_so'
+  ;;
+
 netbsd*)
   version_type=sunos
   need_lib_prefix=no
@@ -28972,6 +29017,12 @@ else
 $as_echo "no" >&6; }
 fi
 
+
+cat >>confdefs.h <<_ACEOF
+#define PA_CFLAGS "$CFLAGS"
+_ACEOF
+
+
 #### Large File-Support (LFS) ####
 
 # Check whether --enable-largefile was given.
@@ -32284,10 +32335,11 @@ pkg_failed=no
 { $as_echo "$as_me:$LINENO: checking for LIBSNDFILE" >&5
 $as_echo_n "checking for LIBSNDFILE... " >&6; }
 
-if test -n "$LIBSNDFILE_CFLAGS"; then
-    pkg_cv_LIBSNDFILE_CFLAGS="$LIBSNDFILE_CFLAGS"
- elif test -n "$PKG_CONFIG"; then
-    if test -n "$PKG_CONFIG" && \
+if test -n "$PKG_CONFIG"; then
+    if test -n "$LIBSNDFILE_CFLAGS"; then
+        pkg_cv_LIBSNDFILE_CFLAGS="$LIBSNDFILE_CFLAGS"
+    else
+        if test -n "$PKG_CONFIG" && \
     { ($as_echo "$as_me:$LINENO: \$PKG_CONFIG --exists --print-errors \" sndfile >= 1.0.10 \"") >&5
   ($PKG_CONFIG --exists --print-errors " sndfile >= 1.0.10 ") 2>&5
   ac_status=$?
@@ -32297,13 +32349,15 @@ if test -n "$LIBSNDFILE_CFLAGS"; then
 else
   pkg_failed=yes
 fi
- else
-    pkg_failed=untried
+    fi
+else
+	pkg_failed=untried
 fi
-if test -n "$LIBSNDFILE_LIBS"; then
-    pkg_cv_LIBSNDFILE_LIBS="$LIBSNDFILE_LIBS"
- elif test -n "$PKG_CONFIG"; then
-    if test -n "$PKG_CONFIG" && \
+if test -n "$PKG_CONFIG"; then
+    if test -n "$LIBSNDFILE_LIBS"; then
+        pkg_cv_LIBSNDFILE_LIBS="$LIBSNDFILE_LIBS"
+    else
+        if test -n "$PKG_CONFIG" && \
     { ($as_echo "$as_me:$LINENO: \$PKG_CONFIG --exists --print-errors \" sndfile >= 1.0.10 \"") >&5
   ($PKG_CONFIG --exists --print-errors " sndfile >= 1.0.10 ") 2>&5
   ac_status=$?
@@ -32313,8 +32367,9 @@ if test -n "$LIBSNDFILE_LIBS"; then
 else
   pkg_failed=yes
 fi
- else
-    pkg_failed=untried
+    fi
+else
+	pkg_failed=untried
 fi
 
 
@@ -32327,9 +32382,9 @@ else
         _pkg_short_errors_supported=no
 fi
         if test $_pkg_short_errors_supported = yes; then
-	        LIBSNDFILE_PKG_ERRORS=`$PKG_CONFIG --short-errors --print-errors " sndfile >= 1.0.10 " 2>&1`
+	        LIBSNDFILE_PKG_ERRORS=`$PKG_CONFIG --short-errors --errors-to-stdout --print-errors " sndfile >= 1.0.10 "`
         else
-	        LIBSNDFILE_PKG_ERRORS=`$PKG_CONFIG --print-errors " sndfile >= 1.0.10 " 2>&1`
+	        LIBSNDFILE_PKG_ERRORS=`$PKG_CONFIG --errors-to-stdout --print-errors " sndfile >= 1.0.10 "`
         fi
 	# Put the nasty error message in config.log where it belongs
 	echo "$LIBSNDFILE_PKG_ERRORS" >&5
@@ -32394,10 +32449,11 @@ pkg_failed=no
 { $as_echo "$as_me:$LINENO: checking for LIBSPEEX" >&5
 $as_echo_n "checking for LIBSPEEX... " >&6; }
 
-if test -n "$LIBSPEEX_CFLAGS"; then
-    pkg_cv_LIBSPEEX_CFLAGS="$LIBSPEEX_CFLAGS"
- elif test -n "$PKG_CONFIG"; then
-    if test -n "$PKG_CONFIG" && \
+if test -n "$PKG_CONFIG"; then
+    if test -n "$LIBSPEEX_CFLAGS"; then
+        pkg_cv_LIBSPEEX_CFLAGS="$LIBSPEEX_CFLAGS"
+    else
+        if test -n "$PKG_CONFIG" && \
     { ($as_echo "$as_me:$LINENO: \$PKG_CONFIG --exists --print-errors \" speexdsp >= 1.2 \"") >&5
   ($PKG_CONFIG --exists --print-errors " speexdsp >= 1.2 ") 2>&5
   ac_status=$?
@@ -32407,13 +32463,15 @@ if test -n "$LIBSPEEX_CFLAGS"; then
 else
   pkg_failed=yes
 fi
- else
-    pkg_failed=untried
+    fi
+else
+	pkg_failed=untried
 fi
-if test -n "$LIBSPEEX_LIBS"; then
-    pkg_cv_LIBSPEEX_LIBS="$LIBSPEEX_LIBS"
- elif test -n "$PKG_CONFIG"; then
-    if test -n "$PKG_CONFIG" && \
+if test -n "$PKG_CONFIG"; then
+    if test -n "$LIBSPEEX_LIBS"; then
+        pkg_cv_LIBSPEEX_LIBS="$LIBSPEEX_LIBS"
+    else
+        if test -n "$PKG_CONFIG" && \
     { ($as_echo "$as_me:$LINENO: \$PKG_CONFIG --exists --print-errors \" speexdsp >= 1.2 \"") >&5
   ($PKG_CONFIG --exists --print-errors " speexdsp >= 1.2 ") 2>&5
   ac_status=$?
@@ -32423,8 +32481,9 @@ if test -n "$LIBSPEEX_LIBS"; then
 else
   pkg_failed=yes
 fi
- else
-    pkg_failed=untried
+    fi
+else
+	pkg_failed=untried
 fi
 
 
@@ -32437,9 +32496,9 @@ else
         _pkg_short_errors_supported=no
 fi
         if test $_pkg_short_errors_supported = yes; then
-	        LIBSPEEX_PKG_ERRORS=`$PKG_CONFIG --short-errors --print-errors " speexdsp >= 1.2 " 2>&1`
+	        LIBSPEEX_PKG_ERRORS=`$PKG_CONFIG --short-errors --errors-to-stdout --print-errors " speexdsp >= 1.2 "`
         else
-	        LIBSPEEX_PKG_ERRORS=`$PKG_CONFIG --print-errors " speexdsp >= 1.2 " 2>&1`
+	        LIBSPEEX_PKG_ERRORS=`$PKG_CONFIG --errors-to-stdout --print-errors " speexdsp >= 1.2 "`
         fi
 	# Put the nasty error message in config.log where it belongs
 	echo "$LIBSPEEX_PKG_ERRORS" >&5
@@ -32696,10 +32755,11 @@ pkg_failed=no
 { $as_echo "$as_me:$LINENO: checking for LIBSAMPLERATE" >&5
 $as_echo_n "checking for LIBSAMPLERATE... " >&6; }
 
-if test -n "$LIBSAMPLERATE_CFLAGS"; then
-    pkg_cv_LIBSAMPLERATE_CFLAGS="$LIBSAMPLERATE_CFLAGS"
- elif test -n "$PKG_CONFIG"; then
-    if test -n "$PKG_CONFIG" && \
+if test -n "$PKG_CONFIG"; then
+    if test -n "$LIBSAMPLERATE_CFLAGS"; then
+        pkg_cv_LIBSAMPLERATE_CFLAGS="$LIBSAMPLERATE_CFLAGS"
+    else
+        if test -n "$PKG_CONFIG" && \
     { ($as_echo "$as_me:$LINENO: \$PKG_CONFIG --exists --print-errors \" samplerate >= 0.1.0 \"") >&5
   ($PKG_CONFIG --exists --print-errors " samplerate >= 0.1.0 ") 2>&5
   ac_status=$?
@@ -32709,13 +32769,15 @@ if test -n "$LIBSAMPLERATE_CFLAGS"; then
 else
   pkg_failed=yes
 fi
- else
-    pkg_failed=untried
+    fi
+else
+	pkg_failed=untried
 fi
-if test -n "$LIBSAMPLERATE_LIBS"; then
-    pkg_cv_LIBSAMPLERATE_LIBS="$LIBSAMPLERATE_LIBS"
- elif test -n "$PKG_CONFIG"; then
-    if test -n "$PKG_CONFIG" && \
+if test -n "$PKG_CONFIG"; then
+    if test -n "$LIBSAMPLERATE_LIBS"; then
+        pkg_cv_LIBSAMPLERATE_LIBS="$LIBSAMPLERATE_LIBS"
+    else
+        if test -n "$PKG_CONFIG" && \
     { ($as_echo "$as_me:$LINENO: \$PKG_CONFIG --exists --print-errors \" samplerate >= 0.1.0 \"") >&5
   ($PKG_CONFIG --exists --print-errors " samplerate >= 0.1.0 ") 2>&5
   ac_status=$?
@@ -32725,8 +32787,9 @@ if test -n "$LIBSAMPLERATE_LIBS"; then
 else
   pkg_failed=yes
 fi
- else
-    pkg_failed=untried
+    fi
+else
+	pkg_failed=untried
 fi
 
 
@@ -32739,9 +32802,9 @@ else
         _pkg_short_errors_supported=no
 fi
         if test $_pkg_short_errors_supported = yes; then
-	        LIBSAMPLERATE_PKG_ERRORS=`$PKG_CONFIG --short-errors --print-errors " samplerate >= 0.1.0 " 2>&1`
+	        LIBSAMPLERATE_PKG_ERRORS=`$PKG_CONFIG --short-errors --errors-to-stdout --print-errors " samplerate >= 0.1.0 "`
         else
-	        LIBSAMPLERATE_PKG_ERRORS=`$PKG_CONFIG --print-errors " samplerate >= 0.1.0 " 2>&1`
+	        LIBSAMPLERATE_PKG_ERRORS=`$PKG_CONFIG --errors-to-stdout --print-errors " samplerate >= 0.1.0 "`
         fi
 	# Put the nasty error message in config.log where it belongs
 	echo "$LIBSAMPLERATE_PKG_ERRORS" >&5
@@ -33020,10 +33083,11 @@ pkg_failed=no
 { $as_echo "$as_me:$LINENO: checking for ASOUNDLIB" >&5
 $as_echo_n "checking for ASOUNDLIB... " >&6; }
 
-if test -n "$ASOUNDLIB_CFLAGS"; then
-    pkg_cv_ASOUNDLIB_CFLAGS="$ASOUNDLIB_CFLAGS"
- elif test -n "$PKG_CONFIG"; then
-    if test -n "$PKG_CONFIG" && \
+if test -n "$PKG_CONFIG"; then
+    if test -n "$ASOUNDLIB_CFLAGS"; then
+        pkg_cv_ASOUNDLIB_CFLAGS="$ASOUNDLIB_CFLAGS"
+    else
+        if test -n "$PKG_CONFIG" && \
     { ($as_echo "$as_me:$LINENO: \$PKG_CONFIG --exists --print-errors \" alsa >= 1.0.17 \"") >&5
   ($PKG_CONFIG --exists --print-errors " alsa >= 1.0.17 ") 2>&5
   ac_status=$?
@@ -33033,13 +33097,15 @@ if test -n "$ASOUNDLIB_CFLAGS"; then
 else
   pkg_failed=yes
 fi
- else
-    pkg_failed=untried
+    fi
+else
+	pkg_failed=untried
 fi
-if test -n "$ASOUNDLIB_LIBS"; then
-    pkg_cv_ASOUNDLIB_LIBS="$ASOUNDLIB_LIBS"
- elif test -n "$PKG_CONFIG"; then
-    if test -n "$PKG_CONFIG" && \
+if test -n "$PKG_CONFIG"; then
+    if test -n "$ASOUNDLIB_LIBS"; then
+        pkg_cv_ASOUNDLIB_LIBS="$ASOUNDLIB_LIBS"
+    else
+        if test -n "$PKG_CONFIG" && \
     { ($as_echo "$as_me:$LINENO: \$PKG_CONFIG --exists --print-errors \" alsa >= 1.0.17 \"") >&5
   ($PKG_CONFIG --exists --print-errors " alsa >= 1.0.17 ") 2>&5
   ac_status=$?
@@ -33049,8 +33115,9 @@ if test -n "$ASOUNDLIB_LIBS"; then
 else
   pkg_failed=yes
 fi
- else
-    pkg_failed=untried
+    fi
+else
+	pkg_failed=untried
 fi
 
 
@@ -33063,9 +33130,9 @@ else
         _pkg_short_errors_supported=no
 fi
         if test $_pkg_short_errors_supported = yes; then
-	        ASOUNDLIB_PKG_ERRORS=`$PKG_CONFIG --short-errors --print-errors " alsa >= 1.0.17 " 2>&1`
+	        ASOUNDLIB_PKG_ERRORS=`$PKG_CONFIG --short-errors --errors-to-stdout --print-errors " alsa >= 1.0.17 "`
         else
-	        ASOUNDLIB_PKG_ERRORS=`$PKG_CONFIG --print-errors " alsa >= 1.0.17 " 2>&1`
+	        ASOUNDLIB_PKG_ERRORS=`$PKG_CONFIG --errors-to-stdout --print-errors " alsa >= 1.0.17 "`
         fi
 	# Put the nasty error message in config.log where it belongs
 	echo "$ASOUNDLIB_PKG_ERRORS" >&5
@@ -33342,10 +33409,11 @@ pkg_failed=no
 { $as_echo "$as_me:$LINENO: checking for GLIB20" >&5
 $as_echo_n "checking for GLIB20... " >&6; }
 
-if test -n "$GLIB20_CFLAGS"; then
-    pkg_cv_GLIB20_CFLAGS="$GLIB20_CFLAGS"
- elif test -n "$PKG_CONFIG"; then
-    if test -n "$PKG_CONFIG" && \
+if test -n "$PKG_CONFIG"; then
+    if test -n "$GLIB20_CFLAGS"; then
+        pkg_cv_GLIB20_CFLAGS="$GLIB20_CFLAGS"
+    else
+        if test -n "$PKG_CONFIG" && \
     { ($as_echo "$as_me:$LINENO: \$PKG_CONFIG --exists --print-errors \" glib-2.0 >= 2.4.0 \"") >&5
   ($PKG_CONFIG --exists --print-errors " glib-2.0 >= 2.4.0 ") 2>&5
   ac_status=$?
@@ -33355,13 +33423,15 @@ if test -n "$GLIB20_CFLAGS"; then
 else
   pkg_failed=yes
 fi
- else
-    pkg_failed=untried
+    fi
+else
+	pkg_failed=untried
 fi
-if test -n "$GLIB20_LIBS"; then
-    pkg_cv_GLIB20_LIBS="$GLIB20_LIBS"
- elif test -n "$PKG_CONFIG"; then
-    if test -n "$PKG_CONFIG" && \
+if test -n "$PKG_CONFIG"; then
+    if test -n "$GLIB20_LIBS"; then
+        pkg_cv_GLIB20_LIBS="$GLIB20_LIBS"
+    else
+        if test -n "$PKG_CONFIG" && \
     { ($as_echo "$as_me:$LINENO: \$PKG_CONFIG --exists --print-errors \" glib-2.0 >= 2.4.0 \"") >&5
   ($PKG_CONFIG --exists --print-errors " glib-2.0 >= 2.4.0 ") 2>&5
   ac_status=$?
@@ -33371,8 +33441,9 @@ if test -n "$GLIB20_LIBS"; then
 else
   pkg_failed=yes
 fi
- else
-    pkg_failed=untried
+    fi
+else
+	pkg_failed=untried
 fi
 
 
@@ -33385,9 +33456,9 @@ else
         _pkg_short_errors_supported=no
 fi
         if test $_pkg_short_errors_supported = yes; then
-	        GLIB20_PKG_ERRORS=`$PKG_CONFIG --short-errors --print-errors " glib-2.0 >= 2.4.0 " 2>&1`
+	        GLIB20_PKG_ERRORS=`$PKG_CONFIG --short-errors --errors-to-stdout --print-errors " glib-2.0 >= 2.4.0 "`
         else
-	        GLIB20_PKG_ERRORS=`$PKG_CONFIG --print-errors " glib-2.0 >= 2.4.0 " 2>&1`
+	        GLIB20_PKG_ERRORS=`$PKG_CONFIG --errors-to-stdout --print-errors " glib-2.0 >= 2.4.0 "`
         fi
 	# Put the nasty error message in config.log where it belongs
 	echo "$GLIB20_PKG_ERRORS" >&5
@@ -33458,10 +33529,11 @@ pkg_failed=no
 { $as_echo "$as_me:$LINENO: checking for GCONF" >&5
 $as_echo_n "checking for GCONF... " >&6; }
 
-if test -n "$GCONF_CFLAGS"; then
-    pkg_cv_GCONF_CFLAGS="$GCONF_CFLAGS"
- elif test -n "$PKG_CONFIG"; then
-    if test -n "$PKG_CONFIG" && \
+if test -n "$PKG_CONFIG"; then
+    if test -n "$GCONF_CFLAGS"; then
+        pkg_cv_GCONF_CFLAGS="$GCONF_CFLAGS"
+    else
+        if test -n "$PKG_CONFIG" && \
     { ($as_echo "$as_me:$LINENO: \$PKG_CONFIG --exists --print-errors \" gconf-2.0 >= 2.4.0 \"") >&5
   ($PKG_CONFIG --exists --print-errors " gconf-2.0 >= 2.4.0 ") 2>&5
   ac_status=$?
@@ -33471,13 +33543,15 @@ if test -n "$GCONF_CFLAGS"; then
 else
   pkg_failed=yes
 fi
- else
-    pkg_failed=untried
+    fi
+else
+	pkg_failed=untried
 fi
-if test -n "$GCONF_LIBS"; then
-    pkg_cv_GCONF_LIBS="$GCONF_LIBS"
- elif test -n "$PKG_CONFIG"; then
-    if test -n "$PKG_CONFIG" && \
+if test -n "$PKG_CONFIG"; then
+    if test -n "$GCONF_LIBS"; then
+        pkg_cv_GCONF_LIBS="$GCONF_LIBS"
+    else
+        if test -n "$PKG_CONFIG" && \
     { ($as_echo "$as_me:$LINENO: \$PKG_CONFIG --exists --print-errors \" gconf-2.0 >= 2.4.0 \"") >&5
   ($PKG_CONFIG --exists --print-errors " gconf-2.0 >= 2.4.0 ") 2>&5
   ac_status=$?
@@ -33487,8 +33561,9 @@ if test -n "$GCONF_LIBS"; then
 else
   pkg_failed=yes
 fi
- else
-    pkg_failed=untried
+    fi
+else
+	pkg_failed=untried
 fi
 
 
@@ -33501,9 +33576,9 @@ else
         _pkg_short_errors_supported=no
 fi
         if test $_pkg_short_errors_supported = yes; then
-	        GCONF_PKG_ERRORS=`$PKG_CONFIG --short-errors --print-errors " gconf-2.0 >= 2.4.0 " 2>&1`
+	        GCONF_PKG_ERRORS=`$PKG_CONFIG --short-errors --errors-to-stdout --print-errors " gconf-2.0 >= 2.4.0 "`
         else
-	        GCONF_PKG_ERRORS=`$PKG_CONFIG --print-errors " gconf-2.0 >= 2.4.0 " 2>&1`
+	        GCONF_PKG_ERRORS=`$PKG_CONFIG --errors-to-stdout --print-errors " gconf-2.0 >= 2.4.0 "`
         fi
 	# Put the nasty error message in config.log where it belongs
 	echo "$GCONF_PKG_ERRORS" >&5
@@ -33574,10 +33649,11 @@ pkg_failed=no
 { $as_echo "$as_me:$LINENO: checking for AVAHI" >&5
 $as_echo_n "checking for AVAHI... " >&6; }
 
-if test -n "$AVAHI_CFLAGS"; then
-    pkg_cv_AVAHI_CFLAGS="$AVAHI_CFLAGS"
- elif test -n "$PKG_CONFIG"; then
-    if test -n "$PKG_CONFIG" && \
+if test -n "$PKG_CONFIG"; then
+    if test -n "$AVAHI_CFLAGS"; then
+        pkg_cv_AVAHI_CFLAGS="$AVAHI_CFLAGS"
+    else
+        if test -n "$PKG_CONFIG" && \
     { ($as_echo "$as_me:$LINENO: \$PKG_CONFIG --exists --print-errors \" avahi-client >= 0.6.0 \"") >&5
   ($PKG_CONFIG --exists --print-errors " avahi-client >= 0.6.0 ") 2>&5
   ac_status=$?
@@ -33587,13 +33663,15 @@ if test -n "$AVAHI_CFLAGS"; then
 else
   pkg_failed=yes
 fi
- else
-    pkg_failed=untried
+    fi
+else
+	pkg_failed=untried
 fi
-if test -n "$AVAHI_LIBS"; then
-    pkg_cv_AVAHI_LIBS="$AVAHI_LIBS"
- elif test -n "$PKG_CONFIG"; then
-    if test -n "$PKG_CONFIG" && \
+if test -n "$PKG_CONFIG"; then
+    if test -n "$AVAHI_LIBS"; then
+        pkg_cv_AVAHI_LIBS="$AVAHI_LIBS"
+    else
+        if test -n "$PKG_CONFIG" && \
     { ($as_echo "$as_me:$LINENO: \$PKG_CONFIG --exists --print-errors \" avahi-client >= 0.6.0 \"") >&5
   ($PKG_CONFIG --exists --print-errors " avahi-client >= 0.6.0 ") 2>&5
   ac_status=$?
@@ -33603,8 +33681,9 @@ if test -n "$AVAHI_LIBS"; then
 else
   pkg_failed=yes
 fi
- else
-    pkg_failed=untried
+    fi
+else
+	pkg_failed=untried
 fi
 
 
@@ -33617,9 +33696,9 @@ else
         _pkg_short_errors_supported=no
 fi
         if test $_pkg_short_errors_supported = yes; then
-	        AVAHI_PKG_ERRORS=`$PKG_CONFIG --short-errors --print-errors " avahi-client >= 0.6.0 " 2>&1`
+	        AVAHI_PKG_ERRORS=`$PKG_CONFIG --short-errors --errors-to-stdout --print-errors " avahi-client >= 0.6.0 "`
         else
-	        AVAHI_PKG_ERRORS=`$PKG_CONFIG --print-errors " avahi-client >= 0.6.0 " 2>&1`
+	        AVAHI_PKG_ERRORS=`$PKG_CONFIG --errors-to-stdout --print-errors " avahi-client >= 0.6.0 "`
         fi
 	# Put the nasty error message in config.log where it belongs
 	echo "$AVAHI_PKG_ERRORS" >&5
@@ -33673,10 +33752,11 @@ pkg_failed=no
 { $as_echo "$as_me:$LINENO: checking for LIBOIL" >&5
 $as_echo_n "checking for LIBOIL... " >&6; }
 
-if test -n "$LIBOIL_CFLAGS"; then
-    pkg_cv_LIBOIL_CFLAGS="$LIBOIL_CFLAGS"
- elif test -n "$PKG_CONFIG"; then
-    if test -n "$PKG_CONFIG" && \
+if test -n "$PKG_CONFIG"; then
+    if test -n "$LIBOIL_CFLAGS"; then
+        pkg_cv_LIBOIL_CFLAGS="$LIBOIL_CFLAGS"
+    else
+        if test -n "$PKG_CONFIG" && \
     { ($as_echo "$as_me:$LINENO: \$PKG_CONFIG --exists --print-errors \" liboil-0.3 >= 0.3.0 \"") >&5
   ($PKG_CONFIG --exists --print-errors " liboil-0.3 >= 0.3.0 ") 2>&5
   ac_status=$?
@@ -33686,13 +33766,15 @@ if test -n "$LIBOIL_CFLAGS"; then
 else
   pkg_failed=yes
 fi
- else
-    pkg_failed=untried
+    fi
+else
+	pkg_failed=untried
 fi
-if test -n "$LIBOIL_LIBS"; then
-    pkg_cv_LIBOIL_LIBS="$LIBOIL_LIBS"
- elif test -n "$PKG_CONFIG"; then
-    if test -n "$PKG_CONFIG" && \
+if test -n "$PKG_CONFIG"; then
+    if test -n "$LIBOIL_LIBS"; then
+        pkg_cv_LIBOIL_LIBS="$LIBOIL_LIBS"
+    else
+        if test -n "$PKG_CONFIG" && \
     { ($as_echo "$as_me:$LINENO: \$PKG_CONFIG --exists --print-errors \" liboil-0.3 >= 0.3.0 \"") >&5
   ($PKG_CONFIG --exists --print-errors " liboil-0.3 >= 0.3.0 ") 2>&5
   ac_status=$?
@@ -33702,8 +33784,9 @@ if test -n "$LIBOIL_LIBS"; then
 else
   pkg_failed=yes
 fi
- else
-    pkg_failed=untried
+    fi
+else
+	pkg_failed=untried
 fi
 
 
@@ -33716,9 +33799,9 @@ else
         _pkg_short_errors_supported=no
 fi
         if test $_pkg_short_errors_supported = yes; then
-	        LIBOIL_PKG_ERRORS=`$PKG_CONFIG --short-errors --print-errors " liboil-0.3 >= 0.3.0 " 2>&1`
+	        LIBOIL_PKG_ERRORS=`$PKG_CONFIG --short-errors --errors-to-stdout --print-errors " liboil-0.3 >= 0.3.0 "`
         else
-	        LIBOIL_PKG_ERRORS=`$PKG_CONFIG --print-errors " liboil-0.3 >= 0.3.0 " 2>&1`
+	        LIBOIL_PKG_ERRORS=`$PKG_CONFIG --errors-to-stdout --print-errors " liboil-0.3 >= 0.3.0 "`
         fi
 	# Put the nasty error message in config.log where it belongs
 	echo "$LIBOIL_PKG_ERRORS" >&5
@@ -33802,10 +33885,11 @@ pkg_failed=no
 { $as_echo "$as_me:$LINENO: checking for JACK" >&5
 $as_echo_n "checking for JACK... " >&6; }
 
-if test -n "$JACK_CFLAGS"; then
-    pkg_cv_JACK_CFLAGS="$JACK_CFLAGS"
- elif test -n "$PKG_CONFIG"; then
-    if test -n "$PKG_CONFIG" && \
+if test -n "$PKG_CONFIG"; then
+    if test -n "$JACK_CFLAGS"; then
+        pkg_cv_JACK_CFLAGS="$JACK_CFLAGS"
+    else
+        if test -n "$PKG_CONFIG" && \
     { ($as_echo "$as_me:$LINENO: \$PKG_CONFIG --exists --print-errors \" jack >= 0.100 \"") >&5
   ($PKG_CONFIG --exists --print-errors " jack >= 0.100 ") 2>&5
   ac_status=$?
@@ -33815,13 +33899,15 @@ if test -n "$JACK_CFLAGS"; then
 else
   pkg_failed=yes
 fi
- else
-    pkg_failed=untried
+    fi
+else
+	pkg_failed=untried
 fi
-if test -n "$JACK_LIBS"; then
-    pkg_cv_JACK_LIBS="$JACK_LIBS"
- elif test -n "$PKG_CONFIG"; then
-    if test -n "$PKG_CONFIG" && \
+if test -n "$PKG_CONFIG"; then
+    if test -n "$JACK_LIBS"; then
+        pkg_cv_JACK_LIBS="$JACK_LIBS"
+    else
+        if test -n "$PKG_CONFIG" && \
     { ($as_echo "$as_me:$LINENO: \$PKG_CONFIG --exists --print-errors \" jack >= 0.100 \"") >&5
   ($PKG_CONFIG --exists --print-errors " jack >= 0.100 ") 2>&5
   ac_status=$?
@@ -33831,8 +33917,9 @@ if test -n "$JACK_LIBS"; then
 else
   pkg_failed=yes
 fi
- else
-    pkg_failed=untried
+    fi
+else
+	pkg_failed=untried
 fi
 
 
@@ -33845,9 +33932,9 @@ else
         _pkg_short_errors_supported=no
 fi
         if test $_pkg_short_errors_supported = yes; then
-	        JACK_PKG_ERRORS=`$PKG_CONFIG --short-errors --print-errors " jack >= 0.100 " 2>&1`
+	        JACK_PKG_ERRORS=`$PKG_CONFIG --short-errors --errors-to-stdout --print-errors " jack >= 0.100 "`
         else
-	        JACK_PKG_ERRORS=`$PKG_CONFIG --print-errors " jack >= 0.100 " 2>&1`
+	        JACK_PKG_ERRORS=`$PKG_CONFIG --errors-to-stdout --print-errors " jack >= 0.100 "`
         fi
 	# Put the nasty error message in config.log where it belongs
 	echo "$JACK_PKG_ERRORS" >&5
@@ -33918,10 +34005,11 @@ pkg_failed=no
 { $as_echo "$as_me:$LINENO: checking for LIBASYNCNS" >&5
 $as_echo_n "checking for LIBASYNCNS... " >&6; }
 
-if test -n "$LIBASYNCNS_CFLAGS"; then
-    pkg_cv_LIBASYNCNS_CFLAGS="$LIBASYNCNS_CFLAGS"
- elif test -n "$PKG_CONFIG"; then
-    if test -n "$PKG_CONFIG" && \
+if test -n "$PKG_CONFIG"; then
+    if test -n "$LIBASYNCNS_CFLAGS"; then
+        pkg_cv_LIBASYNCNS_CFLAGS="$LIBASYNCNS_CFLAGS"
+    else
+        if test -n "$PKG_CONFIG" && \
     { ($as_echo "$as_me:$LINENO: \$PKG_CONFIG --exists --print-errors \" libasyncns >= 0.1 \"") >&5
   ($PKG_CONFIG --exists --print-errors " libasyncns >= 0.1 ") 2>&5
   ac_status=$?
@@ -33931,13 +34019,15 @@ if test -n "$LIBASYNCNS_CFLAGS"; then
 else
   pkg_failed=yes
 fi
- else
-    pkg_failed=untried
+    fi
+else
+	pkg_failed=untried
 fi
-if test -n "$LIBASYNCNS_LIBS"; then
-    pkg_cv_LIBASYNCNS_LIBS="$LIBASYNCNS_LIBS"
- elif test -n "$PKG_CONFIG"; then
-    if test -n "$PKG_CONFIG" && \
+if test -n "$PKG_CONFIG"; then
+    if test -n "$LIBASYNCNS_LIBS"; then
+        pkg_cv_LIBASYNCNS_LIBS="$LIBASYNCNS_LIBS"
+    else
+        if test -n "$PKG_CONFIG" && \
     { ($as_echo "$as_me:$LINENO: \$PKG_CONFIG --exists --print-errors \" libasyncns >= 0.1 \"") >&5
   ($PKG_CONFIG --exists --print-errors " libasyncns >= 0.1 ") 2>&5
   ac_status=$?
@@ -33947,8 +34037,9 @@ if test -n "$LIBASYNCNS_LIBS"; then
 else
   pkg_failed=yes
 fi
- else
-    pkg_failed=untried
+    fi
+else
+	pkg_failed=untried
 fi
 
 
@@ -33961,9 +34052,9 @@ else
         _pkg_short_errors_supported=no
 fi
         if test $_pkg_short_errors_supported = yes; then
-	        LIBASYNCNS_PKG_ERRORS=`$PKG_CONFIG --short-errors --print-errors " libasyncns >= 0.1 " 2>&1`
+	        LIBASYNCNS_PKG_ERRORS=`$PKG_CONFIG --short-errors --errors-to-stdout --print-errors " libasyncns >= 0.1 "`
         else
-	        LIBASYNCNS_PKG_ERRORS=`$PKG_CONFIG --print-errors " libasyncns >= 0.1 " 2>&1`
+	        LIBASYNCNS_PKG_ERRORS=`$PKG_CONFIG --errors-to-stdout --print-errors " libasyncns >= 0.1 "`
         fi
 	# Put the nasty error message in config.log where it belongs
 	echo "$LIBASYNCNS_PKG_ERRORS" >&5
@@ -34391,10 +34482,11 @@ pkg_failed=no
 { $as_echo "$as_me:$LINENO: checking for HAL" >&5
 $as_echo_n "checking for HAL... " >&6; }
 
-if test -n "$HAL_CFLAGS"; then
-    pkg_cv_HAL_CFLAGS="$HAL_CFLAGS"
- elif test -n "$PKG_CONFIG"; then
-    if test -n "$PKG_CONFIG" && \
+if test -n "$PKG_CONFIG"; then
+    if test -n "$HAL_CFLAGS"; then
+        pkg_cv_HAL_CFLAGS="$HAL_CFLAGS"
+    else
+        if test -n "$PKG_CONFIG" && \
     { ($as_echo "$as_me:$LINENO: \$PKG_CONFIG --exists --print-errors \" hal >= 0.5.7 \"") >&5
   ($PKG_CONFIG --exists --print-errors " hal >= 0.5.7 ") 2>&5
   ac_status=$?
@@ -34404,13 +34496,15 @@ if test -n "$HAL_CFLAGS"; then
 else
   pkg_failed=yes
 fi
- else
-    pkg_failed=untried
+    fi
+else
+	pkg_failed=untried
 fi
-if test -n "$HAL_LIBS"; then
-    pkg_cv_HAL_LIBS="$HAL_LIBS"
- elif test -n "$PKG_CONFIG"; then
-    if test -n "$PKG_CONFIG" && \
+if test -n "$PKG_CONFIG"; then
+    if test -n "$HAL_LIBS"; then
+        pkg_cv_HAL_LIBS="$HAL_LIBS"
+    else
+        if test -n "$PKG_CONFIG" && \
     { ($as_echo "$as_me:$LINENO: \$PKG_CONFIG --exists --print-errors \" hal >= 0.5.7 \"") >&5
   ($PKG_CONFIG --exists --print-errors " hal >= 0.5.7 ") 2>&5
   ac_status=$?
@@ -34420,8 +34514,9 @@ if test -n "$HAL_LIBS"; then
 else
   pkg_failed=yes
 fi
- else
-    pkg_failed=untried
+    fi
+else
+	pkg_failed=untried
 fi
 
 
@@ -34434,9 +34529,9 @@ else
         _pkg_short_errors_supported=no
 fi
         if test $_pkg_short_errors_supported = yes; then
-	        HAL_PKG_ERRORS=`$PKG_CONFIG --short-errors --print-errors " hal >= 0.5.7 " 2>&1`
+	        HAL_PKG_ERRORS=`$PKG_CONFIG --short-errors --errors-to-stdout --print-errors " hal >= 0.5.7 "`
         else
-	        HAL_PKG_ERRORS=`$PKG_CONFIG --print-errors " hal >= 0.5.7 " 2>&1`
+	        HAL_PKG_ERRORS=`$PKG_CONFIG --errors-to-stdout --print-errors " hal >= 0.5.7 "`
         fi
 	# Put the nasty error message in config.log where it belongs
 	echo "$HAL_PKG_ERRORS" >&5
@@ -34506,10 +34601,11 @@ pkg_failed=no
 { $as_echo "$as_me:$LINENO: checking for BLUEZ" >&5
 $as_echo_n "checking for BLUEZ... " >&6; }
 
-if test -n "$BLUEZ_CFLAGS"; then
-    pkg_cv_BLUEZ_CFLAGS="$BLUEZ_CFLAGS"
- elif test -n "$PKG_CONFIG"; then
-    if test -n "$PKG_CONFIG" && \
+if test -n "$PKG_CONFIG"; then
+    if test -n "$BLUEZ_CFLAGS"; then
+        pkg_cv_BLUEZ_CFLAGS="$BLUEZ_CFLAGS"
+    else
+        if test -n "$PKG_CONFIG" && \
     { ($as_echo "$as_me:$LINENO: \$PKG_CONFIG --exists --print-errors \" bluez >= 3.0 \"") >&5
   ($PKG_CONFIG --exists --print-errors " bluez >= 3.0 ") 2>&5
   ac_status=$?
@@ -34519,13 +34615,15 @@ if test -n "$BLUEZ_CFLAGS"; then
 else
   pkg_failed=yes
 fi
- else
-    pkg_failed=untried
+    fi
+else
+	pkg_failed=untried
 fi
-if test -n "$BLUEZ_LIBS"; then
-    pkg_cv_BLUEZ_LIBS="$BLUEZ_LIBS"
- elif test -n "$PKG_CONFIG"; then
-    if test -n "$PKG_CONFIG" && \
+if test -n "$PKG_CONFIG"; then
+    if test -n "$BLUEZ_LIBS"; then
+        pkg_cv_BLUEZ_LIBS="$BLUEZ_LIBS"
+    else
+        if test -n "$PKG_CONFIG" && \
     { ($as_echo "$as_me:$LINENO: \$PKG_CONFIG --exists --print-errors \" bluez >= 3.0 \"") >&5
   ($PKG_CONFIG --exists --print-errors " bluez >= 3.0 ") 2>&5
   ac_status=$?
@@ -34535,8 +34633,9 @@ if test -n "$BLUEZ_LIBS"; then
 else
   pkg_failed=yes
 fi
- else
-    pkg_failed=untried
+    fi
+else
+	pkg_failed=untried
 fi
 
 
@@ -34549,9 +34648,9 @@ else
         _pkg_short_errors_supported=no
 fi
         if test $_pkg_short_errors_supported = yes; then
-	        BLUEZ_PKG_ERRORS=`$PKG_CONFIG --short-errors --print-errors " bluez >= 3.0 " 2>&1`
+	        BLUEZ_PKG_ERRORS=`$PKG_CONFIG --short-errors --errors-to-stdout --print-errors " bluez >= 3.0 "`
         else
-	        BLUEZ_PKG_ERRORS=`$PKG_CONFIG --print-errors " bluez >= 3.0 " 2>&1`
+	        BLUEZ_PKG_ERRORS=`$PKG_CONFIG --errors-to-stdout --print-errors " bluez >= 3.0 "`
         fi
 	# Put the nasty error message in config.log where it belongs
 	echo "$BLUEZ_PKG_ERRORS" >&5
@@ -34627,10 +34726,11 @@ pkg_failed=no
 { $as_echo "$as_me:$LINENO: checking for DBUS" >&5
 $as_echo_n "checking for DBUS... " >&6; }
 
-if test -n "$DBUS_CFLAGS"; then
-    pkg_cv_DBUS_CFLAGS="$DBUS_CFLAGS"
- elif test -n "$PKG_CONFIG"; then
-    if test -n "$PKG_CONFIG" && \
+if test -n "$PKG_CONFIG"; then
+    if test -n "$DBUS_CFLAGS"; then
+        pkg_cv_DBUS_CFLAGS="$DBUS_CFLAGS"
+    else
+        if test -n "$PKG_CONFIG" && \
     { ($as_echo "$as_me:$LINENO: \$PKG_CONFIG --exists --print-errors \" dbus-1 >= 1.0.0 \"") >&5
   ($PKG_CONFIG --exists --print-errors " dbus-1 >= 1.0.0 ") 2>&5
   ac_status=$?
@@ -34640,13 +34740,15 @@ if test -n "$DBUS_CFLAGS"; then
 else
   pkg_failed=yes
 fi
- else
-    pkg_failed=untried
+    fi
+else
+	pkg_failed=untried
 fi
-if test -n "$DBUS_LIBS"; then
-    pkg_cv_DBUS_LIBS="$DBUS_LIBS"
- elif test -n "$PKG_CONFIG"; then
-    if test -n "$PKG_CONFIG" && \
+if test -n "$PKG_CONFIG"; then
+    if test -n "$DBUS_LIBS"; then
+        pkg_cv_DBUS_LIBS="$DBUS_LIBS"
+    else
+        if test -n "$PKG_CONFIG" && \
     { ($as_echo "$as_me:$LINENO: \$PKG_CONFIG --exists --print-errors \" dbus-1 >= 1.0.0 \"") >&5
   ($PKG_CONFIG --exists --print-errors " dbus-1 >= 1.0.0 ") 2>&5
   ac_status=$?
@@ -34656,8 +34758,9 @@ if test -n "$DBUS_LIBS"; then
 else
   pkg_failed=yes
 fi
- else
-    pkg_failed=untried
+    fi
+else
+	pkg_failed=untried
 fi
 
 
@@ -34670,9 +34773,9 @@ else
         _pkg_short_errors_supported=no
 fi
         if test $_pkg_short_errors_supported = yes; then
-	        DBUS_PKG_ERRORS=`$PKG_CONFIG --short-errors --print-errors " dbus-1 >= 1.0.0 " 2>&1`
+	        DBUS_PKG_ERRORS=`$PKG_CONFIG --short-errors --errors-to-stdout --print-errors " dbus-1 >= 1.0.0 "`
         else
-	        DBUS_PKG_ERRORS=`$PKG_CONFIG --print-errors " dbus-1 >= 1.0.0 " 2>&1`
+	        DBUS_PKG_ERRORS=`$PKG_CONFIG --errors-to-stdout --print-errors " dbus-1 >= 1.0.0 "`
         fi
 	# Put the nasty error message in config.log where it belongs
 	echo "$DBUS_PKG_ERRORS" >&5
@@ -34854,10 +34957,11 @@ pkg_failed=no
 { $as_echo "$as_me:$LINENO: checking for POLKIT" >&5
 $as_echo_n "checking for POLKIT... " >&6; }
 
-if test -n "$POLKIT_CFLAGS"; then
-    pkg_cv_POLKIT_CFLAGS="$POLKIT_CFLAGS"
- elif test -n "$PKG_CONFIG"; then
-    if test -n "$PKG_CONFIG" && \
+if test -n "$PKG_CONFIG"; then
+    if test -n "$POLKIT_CFLAGS"; then
+        pkg_cv_POLKIT_CFLAGS="$POLKIT_CFLAGS"
+    else
+        if test -n "$PKG_CONFIG" && \
     { ($as_echo "$as_me:$LINENO: \$PKG_CONFIG --exists --print-errors \" polkit-dbus >= 0.7 \"") >&5
   ($PKG_CONFIG --exists --print-errors " polkit-dbus >= 0.7 ") 2>&5
   ac_status=$?
@@ -34867,13 +34971,15 @@ if test -n "$POLKIT_CFLAGS"; then
 else
   pkg_failed=yes
 fi
- else
-    pkg_failed=untried
+    fi
+else
+	pkg_failed=untried
 fi
-if test -n "$POLKIT_LIBS"; then
-    pkg_cv_POLKIT_LIBS="$POLKIT_LIBS"
- elif test -n "$PKG_CONFIG"; then
-    if test -n "$PKG_CONFIG" && \
+if test -n "$PKG_CONFIG"; then
+    if test -n "$POLKIT_LIBS"; then
+        pkg_cv_POLKIT_LIBS="$POLKIT_LIBS"
+    else
+        if test -n "$PKG_CONFIG" && \
     { ($as_echo "$as_me:$LINENO: \$PKG_CONFIG --exists --print-errors \" polkit-dbus >= 0.7 \"") >&5
   ($PKG_CONFIG --exists --print-errors " polkit-dbus >= 0.7 ") 2>&5
   ac_status=$?
@@ -34883,8 +34989,9 @@ if test -n "$POLKIT_LIBS"; then
 else
   pkg_failed=yes
 fi
- else
-    pkg_failed=untried
+    fi
+else
+	pkg_failed=untried
 fi
 
 
@@ -34897,9 +35004,9 @@ else
         _pkg_short_errors_supported=no
 fi
         if test $_pkg_short_errors_supported = yes; then
-	        POLKIT_PKG_ERRORS=`$PKG_CONFIG --short-errors --print-errors " polkit-dbus >= 0.7 " 2>&1`
+	        POLKIT_PKG_ERRORS=`$PKG_CONFIG --short-errors --errors-to-stdout --print-errors " polkit-dbus >= 0.7 "`
         else
-	        POLKIT_PKG_ERRORS=`$PKG_CONFIG --print-errors " polkit-dbus >= 0.7 " 2>&1`
+	        POLKIT_PKG_ERRORS=`$PKG_CONFIG --errors-to-stdout --print-errors " polkit-dbus >= 0.7 "`
         fi
 	# Put the nasty error message in config.log where it belongs
 	echo "$POLKIT_PKG_ERRORS" >&5
diff --git a/ltmain.sh b/ltmain.sh
index 2bcb848..0bf3848 100644
--- a/ltmain.sh
+++ b/ltmain.sh
@@ -43,7 +43,7 @@ EXIT_FAILURE=1
 
 PROGRAM=ltmain.sh
 PACKAGE=libtool
-VERSION=1.5.26
+VERSION="1.5.26 Debian 1.5.26-4"
 TIMESTAMP=" (1.1220.2.493 2008/02/01 16:58:18)"
 
 # Be Bourne compatible (taken from Autoconf:_AS_BOURNE_COMPATIBLE).
@@ -2135,7 +2135,10 @@ EOF
 	case $pass in
 	dlopen) libs="$dlfiles" ;;
 	dlpreopen) libs="$dlprefiles" ;;
-	link) libs="$deplibs %DEPLIBS% $dependency_libs" ;;
+	link)
+	  libs="$deplibs %DEPLIBS%"
+	  test "X$link_all_deplibs" != Xno && libs="$libs $dependency_libs"
+	  ;;
 	esac
       fi
       if test "$pass" = dlopen; then
@@ -3269,6 +3272,11 @@ EOF
 	    revision="$number_minor"
 	    lt_irix_increment=no
 	    ;;
+	  *)
+	    $echo "$modename: unknown library version type \`$version_type'" 1>&2
+	    $echo "Fatal configuration error.  See the $PACKAGE docs for more information." 1>&2
+	    exit $EXIT_FAILURE
+	    ;;
 	  esac
 	  ;;
 	no)
diff --git a/src/Makefile.in b/src/Makefile.in
index ec85868..ee29b4a 100644
--- a/src/Makefile.in
+++ b/src/Makefile.in
@@ -184,6 +184,7 @@ noinst_PROGRAMS = mainloop-test$(EXEEXT) mcalign-test$(EXEEXT) \
 @HAVE_ALSA_TRUE@am__append_35 = \
 @HAVE_ALSA_TRUE@		libalsa-util.la \
 @HAVE_ALSA_TRUE@		module-alsa-sink.la \
+@HAVE_ALSA_TRUE@		module-alsa-sink-old.la \
 @HAVE_ALSA_TRUE@		module-alsa-source.la
 
 @HAVE_SOLARIS_TRUE@am__append_36 = \
@@ -799,6 +800,18 @@ libx11wrap_la_LINK = $(LIBTOOL) --tag=CC $(AM_LIBTOOLFLAGS) \
 	$(LIBTOOLFLAGS) --mode=link $(CCLD) $(libx11wrap_la_CFLAGS) \
 	$(CFLAGS) $(libx11wrap_la_LDFLAGS) $(LDFLAGS) -o $@
 @HAVE_X11_TRUE@am_libx11wrap_la_rpath = -rpath $(modlibexecdir)
+module_alsa_sink_old_la_DEPENDENCIES = $(am__DEPENDENCIES_2) \
+	$(am__DEPENDENCIES_1) libalsa-util.la libpulsecore.la
+am_module_alsa_sink_old_la_OBJECTS =  \
+	module_alsa_sink_old_la-module-alsa-sink-old.lo
+module_alsa_sink_old_la_OBJECTS =  \
+	$(am_module_alsa_sink_old_la_OBJECTS)
+module_alsa_sink_old_la_LINK = $(LIBTOOL) --tag=CC $(AM_LIBTOOLFLAGS) \
+	$(LIBTOOLFLAGS) --mode=link $(CCLD) \
+	$(module_alsa_sink_old_la_CFLAGS) $(CFLAGS) \
+	$(module_alsa_sink_old_la_LDFLAGS) $(LDFLAGS) -o $@
+@HAVE_ALSA_TRUE@am_module_alsa_sink_old_la_rpath = -rpath \
+@HAVE_ALSA_TRUE@	$(modlibexecdir)
 module_alsa_sink_la_DEPENDENCIES = $(am__DEPENDENCIES_2) \
 	$(am__DEPENDENCIES_1) libalsa-util.la libpulsecore.la
 am_module_alsa_sink_la_OBJECTS =  \
@@ -1748,6 +1761,7 @@ SOURCES = $(libalsa_util_la_SOURCES) $(libauthkey_prop_la_SOURCES) \
 	$(libsocket_server_la_SOURCES) $(libsocket_util_la_SOURCES) \
 	$(libstrlist_la_SOURCES) $(libtagstruct_la_SOURCES) \
 	$(libx11prop_la_SOURCES) $(libx11wrap_la_SOURCES) \
+	$(module_alsa_sink_old_la_SOURCES) \
 	$(module_alsa_sink_la_SOURCES) \
 	$(module_alsa_source_la_SOURCES) \
 	$(module_always_sink_la_SOURCES) \
@@ -1835,7 +1849,8 @@ DIST_SOURCES = $(libalsa_util_la_SOURCES) \
 	$(libsocket_client_la_SOURCES) $(libsocket_server_la_SOURCES) \
 	$(libsocket_util_la_SOURCES) $(libstrlist_la_SOURCES) \
 	$(libtagstruct_la_SOURCES) $(libx11prop_la_SOURCES) \
-	$(libx11wrap_la_SOURCES) $(module_alsa_sink_la_SOURCES) \
+	$(libx11wrap_la_SOURCES) $(module_alsa_sink_old_la_SOURCES) \
+	$(module_alsa_sink_la_SOURCES) \
 	$(module_alsa_source_la_SOURCES) \
 	$(module_always_sink_la_SOURCES) \
 	$(module_bt_proximity_la_SOURCES) \
@@ -2781,6 +2796,7 @@ SYMDEF_FILES = \
 		modules/module-x11-xsmp-symdef.h \
 		modules/module-oss-symdef.h \
 		modules/module-alsa-sink-symdef.h \
+		modules/module-alsa-sink-old-symdef.h \
 		modules/module-alsa-source-symdef.h \
 		modules/module-solaris-symdef.h \
 		modules/module-waveout-symdef.h \
@@ -2937,6 +2953,10 @@ module_alsa_sink_la_SOURCES = modules/module-alsa-sink.c
 module_alsa_sink_la_LDFLAGS = -module -avoid-version
 module_alsa_sink_la_LIBADD = $(AM_LIBADD) $(ASOUNDLIB_LIBS) libalsa-util.la libpulsecore.la
 module_alsa_sink_la_CFLAGS = $(AM_CFLAGS) $(ASOUNDLIB_CFLAGS)
+module_alsa_sink_old_la_SOURCES = modules/module-alsa-sink-old.c
+module_alsa_sink_old_la_LDFLAGS = -module -avoid-version
+module_alsa_sink_old_la_LIBADD = $(AM_LIBADD) $(ASOUNDLIB_LIBS) libalsa-util.la libpulsecore.la
+module_alsa_sink_old_la_CFLAGS = $(AM_CFLAGS) $(ASOUNDLIB_CFLAGS)
 module_alsa_source_la_SOURCES = modules/module-alsa-source.c
 module_alsa_source_la_LDFLAGS = -module -avoid-version
 module_alsa_source_la_LIBADD = $(AM_LIBADD) $(ASOUNDLIB_LIBS) libalsa-util.la libpulsecore.la
@@ -3245,6 +3265,8 @@ libx11prop.la: $(libx11prop_la_OBJECTS) $(libx11prop_la_DEPENDENCIES)
 	$(libx11prop_la_LINK) $(am_libx11prop_la_rpath) $(libx11prop_la_OBJECTS) $(libx11prop_la_LIBADD) $(LIBS)
 libx11wrap.la: $(libx11wrap_la_OBJECTS) $(libx11wrap_la_DEPENDENCIES) 
 	$(libx11wrap_la_LINK) $(am_libx11wrap_la_rpath) $(libx11wrap_la_OBJECTS) $(libx11wrap_la_LIBADD) $(LIBS)
+module-alsa-sink-old.la: $(module_alsa_sink_old_la_OBJECTS) $(module_alsa_sink_old_la_DEPENDENCIES) 
+	$(module_alsa_sink_old_la_LINK) $(am_module_alsa_sink_old_la_rpath) $(module_alsa_sink_old_la_OBJECTS) $(module_alsa_sink_old_la_LIBADD) $(LIBS)
 module-alsa-sink.la: $(module_alsa_sink_la_OBJECTS) $(module_alsa_sink_la_DEPENDENCIES) 
 	$(module_alsa_sink_la_LINK) $(am_module_alsa_sink_la_rpath) $(module_alsa_sink_la_OBJECTS) $(module_alsa_sink_la_LIBADD) $(LIBS)
 module-alsa-source.la: $(module_alsa_source_la_OBJECTS) $(module_alsa_source_la_DEPENDENCIES) 
@@ -3820,6 +3842,7 @@ distclean-compile:
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/module-solaris.Plo@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/module-tunnel.Plo@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/module_alsa_sink_la-module-alsa-sink.Plo@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/module_alsa_sink_old_la-module-alsa-sink-old.Plo@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/module_alsa_source_la-module-alsa-source.Plo@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/module_always_sink_la-module-always-sink.Plo@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/module_bt_proximity_la-module-bt-proximity.Plo@am__quote@
@@ -5549,6 +5572,13 @@ libx11wrap_la-x11wrap.lo: pulsecore/x11wrap.c
 @AMDEP_TRUE@@am__fastdepCC_FALSE@	DEPDIR=$(DEPDIR) $(CCDEPMODE) $(depcomp) @AMDEPBACKSLASH@
 @am__fastdepCC_FALSE@	$(LIBTOOL) --tag=CC $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=compile $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libx11wrap_la_CFLAGS) $(CFLAGS) -c -o libx11wrap_la-x11wrap.lo `test -f 'pulsecore/x11wrap.c' || echo '$(srcdir)/'`pulsecore/x11wrap.c
 
+module_alsa_sink_old_la-module-alsa-sink-old.lo: modules/module-alsa-sink-old.c
+@am__fastdepCC_TRUE@	$(LIBTOOL) --tag=CC $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=compile $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(module_alsa_sink_old_la_CFLAGS) $(CFLAGS) -MT module_alsa_sink_old_la-module-alsa-sink-old.lo -MD -MP -MF $(DEPDIR)/module_alsa_sink_old_la-module-alsa-sink-old.Tpo -c -o module_alsa_sink_old_la-module-alsa-sink-old.lo `test -f 'modules/module-alsa-sink-old.c' || echo '$(srcdir)/'`modules/module-alsa-sink-old.c
+@am__fastdepCC_TRUE@	mv -f $(DEPDIR)/module_alsa_sink_old_la-module-alsa-sink-old.Tpo $(DEPDIR)/module_alsa_sink_old_la-module-alsa-sink-old.Plo
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	source='modules/module-alsa-sink-old.c' object='module_alsa_sink_old_la-module-alsa-sink-old.lo' libtool=yes @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	DEPDIR=$(DEPDIR) $(CCDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+@am__fastdepCC_FALSE@	$(LIBTOOL) --tag=CC $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=compile $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(module_alsa_sink_old_la_CFLAGS) $(CFLAGS) -c -o module_alsa_sink_old_la-module-alsa-sink-old.lo `test -f 'modules/module-alsa-sink-old.c' || echo '$(srcdir)/'`modules/module-alsa-sink-old.c
+
 module_alsa_sink_la-module-alsa-sink.lo: modules/module-alsa-sink.c
 @am__fastdepCC_TRUE@	$(LIBTOOL) --tag=CC $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=compile $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(module_alsa_sink_la_CFLAGS) $(CFLAGS) -MT module_alsa_sink_la-module-alsa-sink.lo -MD -MP -MF $(DEPDIR)/module_alsa_sink_la-module-alsa-sink.Tpo -c -o module_alsa_sink_la-module-alsa-sink.lo `test -f 'modules/module-alsa-sink.c' || echo '$(srcdir)/'`modules/module-alsa-sink.c
 @am__fastdepCC_TRUE@	mv -f $(DEPDIR)/module_alsa_sink_la-module-alsa-sink.Tpo $(DEPDIR)/module_alsa_sink_la-module-alsa-sink.Plo
@@ -7624,6 +7654,8 @@ uninstall-am: uninstall-binPROGRAMS uninstall-binSCRIPTS \
 	uninstall-xdgautostartDATA
 
 
+MKDIR_P ?= mkdir
+
 $(SYMDEF_FILES): modules/module-defs.h.m4
 	$(MKDIR_P) modules
 	$(MKDIR_P) modules/gconf
