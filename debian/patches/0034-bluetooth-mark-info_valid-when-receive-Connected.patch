From f1daa282f030e4e2381341e0f65faca47c4b891b Mon Sep 17 00:00:00 2001
From: =?utf-8?q?Marc-Andr=C3=A9=20Lureau?= <marc-andre.lureau@nokia.com>
Date: Thu, 19 Mar 2009 16:55:14 +0200
Subject: [PATCH 34/37] bluetooth: mark info_valid when receive Connected

Sometime, we receive the connected signal before GetProperties reply.
---
 src/modules/bluetooth/bluetooth-util.c |    2 ++
 1 files changed, 2 insertions(+), 0 deletions(-)

diff --git a/src/modules/bluetooth/bluetooth-util.c b/src/modules/bluetooth/bluetooth-util.c
index 9e30f89..5213ad6 100644
--- a/src/modules/bluetooth/bluetooth-util.c
+++ b/src/modules/bluetooth/bluetooth-util.c
@@ -653,10 +653,12 @@ static DBusHandlerResult filter_cb(DBusConnection *bus, DBusMessage *m, void *us
             } else if (dbus_message_has_interface(m, "org.bluez.Headset")) {
                 if (parse_audio_property(y, &d->headset_connected, &arg_i) < 0)
                     goto fail;
+		d->headset_info_valid = 1;
 
             }  else if (dbus_message_has_interface(m, "org.bluez.AudioSink")) {
                 if (parse_audio_property(y, &d->audio_sink_connected, &arg_i) < 0)
                     goto fail;
+		d->audio_sink_info_valid = 1;
             }
 
             pa_assert_se(y->mode == MODE_DISCOVER);
-- 
1.6.2.rc1.13.gfd76c.dirty

