From 848ccf9bf73286b374e3be284f455a8e6ed25b03 Mon Sep 17 00:00:00 2001
From: =?utf-8?q?Marc-Andr=C3=A9=20Lureau?= <marc-andre.lureau@nokia.com>
Date: Tue, 24 Mar 2009 16:26:53 +0200
Subject: [PATCH 15/32] bluetooth: warn when switching profile cannot happen

---
 src/modules/bluetooth/module-bluetooth-device.c |    8 ++++++--
 1 files changed, 6 insertions(+), 2 deletions(-)

diff --git a/src/modules/bluetooth/module-bluetooth-device.c b/src/modules/bluetooth/module-bluetooth-device.c
index d25f487..302bfa8 100644
--- a/src/modules/bluetooth/module-bluetooth-device.c
+++ b/src/modules/bluetooth/module-bluetooth-device.c
@@ -1716,10 +1716,14 @@ static int card_set_profile(pa_card *c, pa_card_profile *new_profile) {
 
     d = PA_CARD_PROFILE_DATA(new_profile);
 
-    if (u->device->headset_connected <= 0 && *d == PROFILE_HSP)
+    if (u->device->headset_connected <= 0 && *d == PROFILE_HSP) {
+        pa_log_warn("HSP is not connected, refused to switch profile");
         return -1;
-    else if (u->device->audio_sink_connected <= 0 && *d == PROFILE_A2DP)
+    }
+    else if (u->device->audio_sink_connected <= 0 && *d == PROFILE_A2DP) {
+        pa_log_warn("A2DP is not connected, refused to switch profile");
         return -1;
+    }
 
     if (u->sink) {
         inputs = pa_sink_move_all_start(u->sink);
-- 
1.6.2.rc1.13.gfd76c.dirty

